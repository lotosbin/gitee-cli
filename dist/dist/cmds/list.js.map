{"version":3,"sources":["../../cmds/list.js"],"names":["_https","require","_https2","_interopRequireDefault","_querystring","_querystring2","_homeConfig","_global","_global2","obj","__esModule","default","cfg","load","exports","command","desc","builder","yargs","option","core","username","description","handler","argv","echo","owner","list_repository","data","success","performRequest","access_token","type","page","per_page","endpoint","method","host","dataString","JSON","stringify","headers","length","options","path","req","request","res","setEncoding","responseString","on","console","log","responseObject","parse","write","end"],"mappings":"AAAA;;AAEA,IAAIA,SAASC,QAAQ,OAAR,CAAb;;AAEA,IAAIC,UAAUC,uBAAuBH,MAAvB,CAAd;;AAEA,IAAII,eAAeH,QAAQ,aAAR,CAAnB;;AAEA,IAAII,gBAAgBF,uBAAuBC,YAAvB,CAApB;;AAEA,IAAIE,cAAcL,QAAQ,aAAR,CAAlB;;AAEA,IAAIM,UAAUN,QAAQ,gBAAR,CAAd;;AAEA,IAAIO,WAAWL,uBAAuBI,OAAvB,CAAf;;AAEA,SAASJ,sBAAT,CAAgCM,GAAhC,EAAqC;AAAE,WAAOA,OAAOA,IAAIC,UAAX,GAAwBD,GAAxB,GAA8B,EAAEE,SAASF,GAAX,EAArC;AAAwD;;AAE/F,IAAIG,MAAM,CAAC,GAAGN,YAAYO,IAAhB,EAAsB,UAAtB,CAAV;AACAC,QAAQC,OAAR,GAAkB,MAAlB;AACAD,QAAQE,IAAR,GAAe,mBAAf;AACAF,QAAQG,OAAR,GAAkB,UAAUC,KAAV,EAAiB;AAC/B,WAAOA,MAAMC,MAAN,CAAa,OAAb,EAAsB;AACzBR,iBAASC,IAAIQ,IAAJ,CAASC,QADO;AAEzBC,qBAAa;AAFY,KAAtB,CAAP;AAIH,CALD;AAMAR,QAAQS,OAAR,GAAkB,UAAUC,IAAV,EAAgB;AAC9BC,SAAKD,KAAKE,KAAV;AACAC,oBAAgBH,KAAKE,KAArB,EAA4B,UAAUE,IAAV,EAAgB;AACxCH,aAAKG,IAAL;AACH,KAFD;AAGH,CALD;;AAOA,SAASD,eAAT,CAAyBD,KAAzB,EAAgCG,OAAhC,EAAyC;AACrCC,mBAAe,kBAAkBJ,KAAlB,GAA0B,QAAzC,EAAmD,KAAnD,EAA0D;AACtDK,sBAAcnB,IAAIQ,IAAJ,CAASW,YAD+B;AAEtDC,cAAM,KAFgD;AAGtDC,cAAM,CAHgD;AAItDC,kBAAU;AAJ4C,KAA1D,EAKGL,OALH;AAMH;;AAED,SAASC,cAAT,CAAwBK,QAAxB,EAAkCC,MAAlC,EAA0CR,IAA1C,EAAgDC,OAAhD,EAAyD;AACrD,QAAIQ,OAAO,iBAAX;AACA,QAAIC,aAAaC,KAAKC,SAAL,CAAeZ,IAAf,CAAjB;AACA,QAAIa,UAAU,EAAd;;AAEA,QAAIL,WAAW,KAAf,EAAsB;AAClBD,oBAAY,MAAM9B,cAAcM,OAAd,CAAsB6B,SAAtB,CAAgCZ,IAAhC,CAAlB;AACH,KAFD,MAEO;AACHa,kBAAU;AACN,4BAAgB,kBADV;AAEN,8BAAkBH,WAAWI;AAFvB,SAAV;AAIH;AACD,QAAIC,UAAU;AACVN,cAAMA,IADI;AAEVO,cAAMT,QAFI;AAGVC,gBAAQA,MAHE;AAIVK,iBAASA;AAJC,KAAd;;AAOA,QAAII,MAAM3C,QAAQS,OAAR,CAAgBmC,OAAhB,CAAwBH,OAAxB,EAAiC,UAAUI,GAAV,EAAe;AACtDA,YAAIC,WAAJ,CAAgB,OAAhB;;AAEA,YAAIC,iBAAiB,EAArB;;AAEAF,YAAIG,EAAJ,CAAO,MAAP,EAAe,UAAUtB,IAAV,EAAgB;AAC3BqB,8BAAkBrB,IAAlB;AACH,SAFD;;AAIAmB,YAAIG,EAAJ,CAAO,KAAP,EAAc,YAAY;AACtBC,oBAAQC,GAAR,CAAYH,cAAZ;AACA,gBAAII,iBAAiBd,KAAKe,KAAL,CAAWL,cAAX,CAArB;AACApB,oBAAQwB,cAAR;AACH,SAJD;AAKH,KAdS,CAAV;;AAgBAR,QAAIU,KAAJ,CAAUjB,UAAV;AACAO,QAAIW,GAAJ;AACH;AACD","file":"list.js","sourcesContent":["\"use strict\";\n\nvar _https = require(\"https\");\n\nvar _https2 = _interopRequireDefault(_https);\n\nvar _querystring = require(\"querystring\");\n\nvar _querystring2 = _interopRequireDefault(_querystring);\n\nvar _homeConfig = require(\"home-config\");\n\nvar _global = require(\"shelljs/global\");\n\nvar _global2 = _interopRequireDefault(_global);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar cfg = (0, _homeConfig.load)('.oschina');\nexports.command = 'list';\nexports.desc = 'list repositories';\nexports.builder = function (yargs) {\n    return yargs.option('owner', {\n        default: cfg.core.username,\n        description: 'specific owner'\n    });\n};\nexports.handler = function (argv) {\n    echo(argv.owner);\n    list_repository(argv.owner, function (data) {\n        echo(data);\n    });\n};\n\nfunction list_repository(owner, success) {\n    performRequest('/api/v5/orgs/' + owner + '/repos', 'GET', {\n        access_token: cfg.core.access_token,\n        type: 'all',\n        page: 1,\n        per_page: 1000\n    }, success);\n}\n\nfunction performRequest(endpoint, method, data, success) {\n    var host = 'git.oschina.net';\n    var dataString = JSON.stringify(data);\n    var headers = {};\n\n    if (method === 'GET') {\n        endpoint += '?' + _querystring2.default.stringify(data);\n    } else {\n        headers = {\n            'Content-Type': 'application/json',\n            'Content-Length': dataString.length\n        };\n    }\n    var options = {\n        host: host,\n        path: endpoint,\n        method: method,\n        headers: headers\n    };\n\n    var req = _https2.default.request(options, function (res) {\n        res.setEncoding('utf-8');\n\n        var responseString = '';\n\n        res.on('data', function (data) {\n            responseString += data;\n        });\n\n        res.on('end', function () {\n            console.log(responseString);\n            var responseObject = JSON.parse(responseString);\n            success(responseObject);\n        });\n    });\n\n    req.write(dataString);\n    req.end();\n}\n//# sourceMappingURL=list.js.map"]}